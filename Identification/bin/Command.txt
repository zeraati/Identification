SELECT [a].[CodeMelli] a_CodeMelli, [b].[CodeMelli] b_CodeMelli, FROM [_Main].dbo.[TBL_Student_Main] a JOIN [_Main].dbo.[TBL_Student_Iden] b ON Replace(a.[CodeMelli], ' ', '') = Replace(b.[CodeMelli], ' ', '') Where REPLACE(a.[Name],' ','') = REPLACE(b.[Name],' ','')  AND REPLACE(a.[Family],' ','') = REPLACE(b.[Family],' ','')  AND REPLACE(a.[Father],' ','') = REPLACE(b.[Father],' ','')  AND b.ShenasCode=a.ShenasCode AND b.ShenasCode is not null AND b.PBirthDate=a.PBirthDate AND b.PBirthDate is not null  and Replace(a.HomeCity,' ','')=Replace(b.HomeCity,' ','')