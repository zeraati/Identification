SELECT [a].[Name] a_Name,[b].[Name] b_Name FROM [Ehraz].dbo.[TBL_Student_95-02-21] a JOIN [Ehraz].dbo.[TBL_MKsarparast_95-02-21] b ON Replace(a.[STID], ' ', '') = Replace(b.[STID], ' ', '') WHERE (a.[Name] IS NULL OR b.[Name] IS NULL  OR (Replace(a.[Name] ,N'سید','') = Replace(b.[Name], N'سید','')) AND (dbo.GetPercentageOfTwoStringMatching(Replace(a.[Name] ,N'سید','')) = dbo.GetPercentageOfTwoStringMatching(Replace(b.[Name], N'سید',''))) OR (Replace(a.[Name] ,N'میر','') = Replace(b.[Name], N'میر','')) AND (dbo.GetPercentageOfTwoStringMatching(Replace(a.[Name] ,N'میر','')) = dbo.GetPercentageOfTwoStringMatching(Replace(b.[Name], N'میر',''))) OR (Replace(a.[Name] ,N'الله','') = Replace(b.[Name], N'الله','')) AND (dbo.GetPercentageOfTwoStringMatching(Replace(a.[Name] ,N'الله','')) = dbo.GetPercentageOfTwoStringMatching(Replace(b.[Name], N'الله',''))) OR (Replace(a.[Name] ,N'اله','') = Replace(b.[Name], N'اله','')) AND (dbo.GetPercentageOfTwoStringMatching(Replace(a.[Name] ,N'اله','')) = dbo.GetPercentageOfTwoStringMatching(Replace(b.[Name], N'اله','')))) AND b.[STID_vld] IS NULL 