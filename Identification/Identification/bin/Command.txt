SELECT [a].STID a_STID, [b].STID b_STID,[a].[Name] a_Name,[b].[Name] b_Name,[a].[Family] a_Family,[b].[Family] b_Family,[a].[Father] a_Father,[b].[Father] b_Father,[a].[CodeMelli] a_CodeMelli,[b].[CodeMelli] b_CodeMelli,[a].[ShenasCode] a_ShenasCode,[b].[ShenasCode] b_ShenasCode FROM [AmarPartDB].dbo.[TBL_Student_copy] a JOIN [AmarPartDB].dbo.[TBL_MKsarparast_uniq_copy] b ON Replace(a.[STID], ' ', '') = Replace(b.[STID], ' ', '') Where REPLACE(a.[Name],' ','') = REPLACE(b.[Name],' ','')  AND REPLACE(a.[Family],' ','') = REPLACE(b.[Family],' ','')  AND  (a.[Father] IS NULL OR b.[Father] IS NULL ) AND  (Replace(a.[Father] ,'سيد','') = Replace(b.[Father],'سيد','') AND (a.[Father] LIKE N'%سيد%' OR b.[Father] LIKE N'%سيد%') AND a.[Father]<>b.[Father]) OR  (Replace(a.[Father] ,'مير','') = Replace(b.[Father],'مير','') AND (a.[Father] LIKE N'%مير%' OR b.[Father] LIKE N'%مير%') AND a.[Father]<>b.[Father]) OR  (REPLACE(REPLACE(a.[Father], N'الله', ''), N'اله', '') = REPLACE(REPLACE(b.[Father], N'الله', ''), N'اله', '') AND (a.[Father] LIKE N'%اله%' OR b.[Father] LIKE N'%اله%' or a.[Father] LIKE N'%الله%' or b.[Father] LIKE N'%الله%') AND a.[Father]<> b.[Father]) AND a.CodeMelli=b.CodeMelli AND b.CodeMelli is not null  AND b.[STID_vld] IS NULL 